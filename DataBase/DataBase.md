# 数据库复习
**信南436**
* **题量大**
* 注重问题解决
* 知识点较少，填空简答Max20’
* 解决问题（大题）
* 关系代数表达查询 10'
* 熟练SQL语句 10-15'（不会太简单）多组连接，统计，子查询
* 概念模型的设计
* 逻辑模型的设计
* E/R图转换
* ↑20'
* 关系理论，键码求解（判断范式），模式分解
* 综合应用题8'设计的评价分析
* **熟练掌握部分**

## Chap1 数据库概念
* **数据**：能输入计算机并能被计算机程序识别和处理的符号集合。
* **数据库**：存储在计算机内的有组织，可共享的数据集合。
  1. 数据按一定数据模型组织，在描述和存储上具有较小的冗余度
  2. 数据间相互联系
  3. 由数据库管理系统进行管理
* 数据模型：指数据的组织方式，不但表达数据本身，而且表达数据间的联系，以及数据的一致性约束。
  * 三要素：数据结构、数据操作、数据约束。
  * 层次模型、网状模型、关系模型、面型对象的数据模型、对象关系数据模型、XML数据模型
* **数据库管理系统**(DBMS)：对**数据**统一**管理**和**控制**的软件系统。
  * **结构**：查询处理程序、事务管理程序、存储管理程序
* **数据库系统**：数据库+DBMS+应用程序+DBA+计算机系统平台
* **三级体系架构**：物理层--数据库、逻辑层--DBMS、视图层--用户，应用，应用服务器。
  * **视图层**描述用户使用的数据结构。
  * **逻辑层**描述数据库的逻辑结构
  * **物理层**描述数据如何储存。需要知道数据的存储路径，所需空间大小等。
* 数据独立性：**数据**与**应用程序**在一定程度上**相互分离**。
* 逻辑独立性：模式**改变**-->外模式/模式**映像改变**-->外模式**不变**-->应用程序不变。
* 物理独立性：内模式**改变**-->模式/内模式**映像改变**-->模式（尽量）**不变**-->**外模式和应用程序不变**。
* 文件系统：
  * 优点：数据可长期保存、物理结构与逻辑结构有简单区别、数据不属于某一特定程序
  * 缺点：没有同意的数据模型，数据访问困难、数据孤立，容易造成数据冗余和不一致、完整性问题--数据间需要满足的一种一致性约束、更新原子性、并发异常、安全性问题。

## Chap2 关系模型
### 2.1 关系数据模型
* **关系模型**：用二维表（集合）来组织数据及数据之间联系的模型。
* **元组**：表中每一行数据，相当于一个记录值。
* 关系模式：关系名与关系的属性集。S(a, b, c, d)
* 关系实例：对应一个关系模式的元组集合。
* 关系的特点：每个属性都是原子的（多值与组合属性不是）、各**属性不能重名**、行列次序不影响语义、**不能有相同行**。
* **键码**（候选码）：其值能唯一的标识一个元组，且该属性（组）的**任一真子集不能标识**。
  1. 唯一性
  2. 最小性
* **超码**：以键码作为子集的任意属性集。
* **主属性**：构成键码的属性。
* **非主属性**：不构成键码的属性。
* **外码**：关系R中的属性（组）X是另一个关系S的键码。
* **关系数据库**：若干关系构成的集合。数据组织方式用模式图表示。

### 2.2 关系代数
* **关系代数**：抽象的、过程化的查询语言。运算**对象和结果都是关系**。
#### 2.2.1 基本运算
* **传统运算**：交∩，并∪，差-，笛卡尔乘积x
* **关系运算**：选择$\sigma$，投影$\Pi$，改名运算$\rho$，连接运算。

#### 2.2.2 集合运算
* 并兼容关系：两个关系的属性**个数**，各属性**域**相同。
  * 设计运算：交并差

#### 2.2.3 集合运算
* 从关系R中选出满足条件表达式F的元组
$$
 \sigma_F(R)
$$
* F条件表达式：比较&逻辑运算符。

#### 2.2.4 投影
* 从某一关系R中选出某些属性A，构成新的关系
$$
\Pi_A(R)
$$
* 投影结果中**无重复元组**

#### 2.2.5 改名运算
* 把关系R的名称改成另一个名称s。一般对关系运算的结果改名
$$
\rho_s(R)
$$

#### 2.2.6 笛卡尔乘积运算
* R，S属性个数为m,n，元组个数为k<sub>1</sub>,k<sub>2</sub>
* 笛卡尔乘积是一个关系，属性个数m+n，元组个数k<sub>1</sub> $\times$ k<sub>2</sub>。记作
$$
 R \times S
$$

#### 2.2.7 $\theta$连接运算
* 两个关系的元组在满足某些条件下进行匹配，即$\theta$-连接。记为
$$
R \underset{\theta 条件}{\bowtie} S
$$
#### 2.2.8 自然连接
* 两个关系在**公共属性**上进行**等值连接**的运算。
$$
R \bowtie S
$$
#### 2.2.10 复合运算
$$
\Pi_{title, year}(\sigma_{studio="Fox"\bigwedge length\geq 100}(Movies))
$$

#### Example
* 找最大的一个值
$$
\Pi_{balance}(account)-\Pi_{a.balance}(\rho_a(account)\underset{a.balbance < d.balance}{\bowtie}\rho_d(account))
$$

### 2.3 关系的完整性
* 指采用关系模型存储的数据及其间的联系能够正确的表达现实世界。
* **实体完整性**：
  * 保证关系中每个元组都是**可识别**和**唯一**的。所有表都**必须有主键且非空**。
* **参照完整性**：
  * 一个表中的一个元组的存在以另一个表中某一元组的存在为**前提**。利用外码实现。
* **用户定义的完整性**：
  * 域完整性/语义完整性。值的取值范围。
* 插入时检查：实体完整性、参照完整性和用户定义的完整性。
* 删除时检查：参照完整性
* 更新时 = 先删除后插入。

## Chap3 数据库建模与实体联系模型
### 3.1 数据库设计的基本步骤
* 需求分析-->设计概念模型-->设计逻辑模型-->设计物理结构-->系统实现-->试运行及维护
### 3.2 实体-联系模型
#### 3.2.1 基本概念
* **实体**：现实世界中**客观存在**的一个具体或抽象事物，一个实体与其他实体**可以区分**。
* **属性**：描述实体特征的数据项。
  * 简单属性/组合属性；单值属性/多值属性；派生属性：由其他属性计算而来的属性
  * 传统关系模型中，**属性是简单，单值的**。
* **实体集**：具有**相同属性**的一类**实体的集合**。
* **联系**：实体间的**相互关系**。
* **联系集**：两个或多个实体集间，实体间**联系的总集合**。
  * 关系模型中，联系集可以用关系表示。元组中的各个原子来自联系集连接的各个实体。
  * 联系集可以有属性描述联系的特征。一个联系集的所有联系有**相同的属性**。
  * 联系集的度指联系集所**涉及的实体集个数**。
  * 二元联系类型：一对一、一对多、多对多。
    * 联系集联系的实体集中可以有实体没有联系关系。
#### 3.2.2 E-R图
* **多-->一，一<-->一，多--多** 
* **多元**联系**转二元**联系：**构造连接实体集E**
  * 将多远联系R用实体集E替换，生成E与其他实体集之间的联系$R_A$，$R_B$，$R_C$。原R的属性变为E的属性。
#### 3.2.3 E-R图设计问题
* **原则**：**忠实性**(以现实世界为唯一依据)，**避免冗余**(一个事物在一个数据库中只表达一次)，**尽量简单**。
* **步骤**：1.找实体集(n.)；2.找实体集属性；3.找联系(v.);
#### 3.2.4 约束的建模
* **键码**：能标识实体的最小属性集合。有若干键码是需要制定一个**主码**。
* **参照完整性约束**：E-->F的参照完整性约束。指E中存在一个实体e，则F中**必须存在**一个对应的实体f。**用E--)F表示**
* **域约束**：属性**类型**及**取值范围**的约束。
#### 3.2.5 子类实体
* 超类(学生)&子类(本科生)
* 子类**继承超类**的所有**属性和联系**。子类**没有自己的属性**时**不出现**在ER图中
#### 3.2.5 弱实体集
* 弱实体集：**没有主码**的实体集。用**双线矩形**表示，与**提供给他键码的实体集间的联系**用双线菱形。
* 多元联系集转化的实体集一般为弱实体集。
* 弱实体集键码：弱实体的属性+通过多对一联系从强实体集的键码。
### 3.3 ER模型向关系模型转换
#### 3.3.1 强实体集
实体集的主码和属性成为关系模式的主码和属性。
#### 3.3.2 弱实体集
* 关系模式的主属性 = 为弱实体集提供主码的强实体集的主码 + 弱实体集的主码。
* 全部属性 = 强实体集主属性 + 弱实体集所有属性。
#### 3.3.3 联系集的转化
* 为联系建立一个关系模式。相同属性名进行**改名**。
* **多对多**联系：**属性** = 联系本身 + 实体集键码。**键码** = 参与的实体集键码共同构成
* **一对多**：属性同多对多，键码 = 多侧的键码。
  * 可以不单独转化成关系模式，在多方中加联系属性和一方的键码。
* **一对一**联系：同一对多。
#### 3.3.4 子类实体集
* ISA不用转换，只用转换高一层和低一层的实体。
* **方法1**：父类实体建立一个关系模式。子类建立一个关系模式，继承父类的键码+自己的属性。
* **方法2**：**子类实体集不相交且覆盖父类全部范围时**。只给子类建关系模式。属性=父类属性+子类属性。



## Chap4 数据库设计理论




## Chap5 SQL




## Chap6 SQL约束




## Chap7 数据库的安全与控制




